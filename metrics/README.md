## Quality metrics for Slacken (and Kraken 2) classification experiments 

These files (`All_metrics.tsv` and `All_bmetrics.tsv`) contain experimental results for Slacken and Kraken 2. 
Each line in the files corresponds to the classification of a single metagenomic sample with a given set of parameters, 
and then comparing with the known ground truth. For bmetrics, Bracken has also been applied after running either Slacken or Kraken 2.

The following parameters were fixed for all experiments: k (k-mer size) = 35, m (minimizer width) = 31, s = 7.
These are the Kraken 2 defaults.

All_metrics contains a total of 14,080 experiments (compared at species and genus level), and all_bmetrics contains 7,040 
experiments (compared at species level only, since this is more meaningful with Bracken).
A total of 160 samples from six sample groups were classified.

### Common columns in both files

* Library: genomic library (std or rspc)
* Group: sample family (e.g. CAMI2 strain/plant_associated/marine, or the noise model for in silico samples). 
Samples in the same group were classified together in multisample mode.
* Sample: unique sample identifier within the group
* c: confidence score for Slacken/Kraken 2 classification. We evaluated c=0.15, 0.10, 0.05 and 0.00.

### All_metrics.tsv (read binning results, pre-Bracken)

This file was generated by the `compare` command in Slacken.

* Rank: level of comparison (Species or Genus) when comparing with the ground truth. All results in the paper are based 
on a species-level comparison. We also include genus-level experiments here for completeness.

#### Taxon metrics
* taxon_classified: number of identified taxa. A taxon is considered to be identified if it has at least 10 reads 
assigned to it. This test has no relation to the 2-step heuristic threshold (R10, R100 etc).
* taxon_total: total number of taxa in the reference (no threshold) 
* taxon_precision precision of the classified taxon set (|true classified|/|classified|)
* taxon_recall recall of the classified taxon set (|true classified|/|total|)

#### Read metrics

* read_classified: number of classified reads
* read_total: total number of reads in the sample
* read_tp: number of reads correctly classified
* read_vp: number of reads vaguely classified (in the lineage above the true taxon)
* read_fp: number of reads incorrectly classified
* read_fn: number of reads not classified (but that had a ground truth mapping)
* read_ppv: precision of read classifications (|tp|/|tp + fp|)
* read_sensitivity sensitivity of read classifications (|tp|/|total|)
* read_index: hard index (see our paper for details)

#### Read fractions of total metrics

These are the same as the corresponding metrics above, but as fractions of the total number of reads instead of 
absolute counts.
* read_tp_frac 
* read_fp_frac
* read_vp_frac
* read_fn_frac
* read_classified_frac

### All_bmetrics.tsv (read profiling results, post-Bracken)

This file was computed by `scripts/comparison/compare_bracken_kraken.scala`.

#### Ground truth distances

* LSE: LSE (Euclidean) distance from the ground truth mapping. Each taxon is treated as a fraction of reads, so each 
sample is represented as a vector with entries in the range [0,1].
* LSE (log10) LSE distance measured after applying log base 10 to the entries in the vectors.
* L1 L1 (Manhattan) distance from the ground truth mapping. 
* L1 (log10) L1 (Manhattan) distance after applying log base 10 to the entries in the vectors.

#### Taxon metrics

* TP: number of true positive taxa
* FP: number of false positive taxa
* FN: number of false negative taxa
* Precision: precision of the taxon set (|tp|/|tp + fp|)
* Recall: recall of the taxon set (|tp|/|reference|)

#### Other

* Added reads: fraction of reads added by Bracken